{% extends 'ufc/base.html' %}

{% load staticfiles %}

{% block d3 %}

<h1>RESULTS</h1>

{{fighter_name}}
{{fighter_list}}



<h2>Fight history for 

	
</h2>

 
<ul>
<li></li>
</ul>

<!--
	<tr>
		<td>Result</td>
		<td>Opponent</td>
		<td>Event</td>
		<td>Date</td>
		<td>Method</td>
		<td>Round</td>
		<td>Time</td>
		<td>Referee</td>
	</tr>
-->

<table border=0>
<thead>
    <tr>
    {% for attr_head in history.keys %}
       <th>{{ attr_head }}</th>
    {% endfor %}
    </tr>
</thead>
<tbody>
    <tr>
    {% for attr in history.values %}
        <td>{{ attr }}</td>
    {% endfor %}
    </tr>
</tbody>
</table>

<style>
.d3-tip {
  line-height: 1;
  font-weight: bold;
  padding: 12px;
  background: rgba(0, 0, 0, 0.8);
  color: #fff;
  border-radius: 2px;
}

/* Creates a small triangle extender for the tooltip */
.d3-tip:after {
  box-sizing: border-box;
  display: inline;
  font-size: 10px;
  width: 100%;
  line-height: 1;
  color: rgba(0, 0, 0, 0.8);
  content: "\25BC";
  position: absolute;
  text-align: center;
}

/* Style northward tooltips differently */
.d3-tip.n:after {
  margin: -1px 0 0 0;
  top: 100%;
  left: 0;
}

.hl {
	color: red;
}
</style>
<script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
<script type="text/javascript">
	

//set the "value" to the time in seconds of each match

	var test3 = {
		"name": "Ronda Rousey",
		"value": 100,
		"children":[
			{
				"name": "Cat Zingano",
				"value": 40,
				"time": 30,
				"method": "submission",
				"round": 4
			},
			{
				"name": "Miesha Tate",
				"value": 30,
				"time": 57,
				"method": "submission",
				"round": 2
			},
			{
				"name": "some bitch",
				"value": 20,
				"time": 10,
				"method": "KO",
				"round:": 1
			}
		]
	}


	var yol = {{ history|safe }};
	console.log(yol)
	


//---------------------------

var tip = d3.tip()
  .attr('class', 'd3-tip')
  .offset([-10, 0])
  .html(function(d) {
    return "<strong>Method:</strong> <span style='color:red'>" + d.method + "</span><br><strong>Round:</strong> <span style='color:red'>" + d.round + "</span>";
  })


// could use the radius of circles to show match length
var width = 800;
var height = 600;


var canvas = d3.select("body").append("svg")
	.attr("width", width)
	.attr("height", height)
	.append("g")
		.attr("transform", "translate(50, 50)");

var pack = d3.layout.pack()
	.size([width, height - 50])
	.padding(10)

var nodes = pack.nodes(yol);
console.log(nodes);
//bind some data



var node = canvas.selectAll(".node")
	.data(nodes)

	//save the rInit value for future use
	.attr("rInit", function(d, i) { return d.r })

	.enter()
	.append("g")
		.attr("class", "node")
		.attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; })

	node.append("text")
		.attr("font-size", "20px")
		.style("fill", "#004669")
		.style("font-weight", "bold")
		.text(function(d) { return d.children ? d.name : "" })

//append a circle to each node
	
	node.append("circle")
		.attr("rInit", function(d, i) { return d.r })
		.attr("r", function(d) { return d.r; })
		.attr("id", function(d, i) { return "c" + i; })
		.attr("fill", function(d) { return d.method == "submission" ? "steelblue" : "red"; })
		.attr("opacity", 0.25)
		.attr("stroke", "#ADADAD")
		.attr("stroke-width", "2")
		.on('mouseover', function(d, i){
			if(!d.children){
				tip.show(d);
				var selectedCircle = d3.select("#c" + i);
				selectedCircle.transition().duration(250)
				.attr("r", selectedCircle.attr("rInit") * 1.2);
			}
		})
		.on('mouseout', function(d, i){
		      tip.hide(d);

		      // Back to original circle radius
		      var selectedCircle = d3.select("#c" + i)
		      selectedCircle.transition()
		      .attr("r", selectedCircle.attr("rInit") );
		})

    canvas.call(tip);


	node.append("text")
		.attr("font-size", "12px")
		.style("fill", "#000000")
		.style("font-weight", "none")
		.text(function(d) { return d.children ? "" : d.name; });


	//add a pie to show total career time


</script>

{% endblock %}